{
    "id": "org.astra.qtSdk",
    "branch": "1.8",
    "runtime": "org.astra.mainPlatform",
    "runtime-version": "1.8",
    "sdk": "org.astra.mainSdk",
    "cleanup": [
        "/tmp/*",
        "/var/cache",
        "/var/lib/apt",
        "/var/log",
        "/usr/share/doc",
        "/usr/share/man",
        "/usr/share/info",
        "/usr/share/lintian",
        "/usr/share/linda",
        "/var/lib/dpkg/*-old",
        "/var/lib/dbus/machine-id",
        "/usr/share/applications"
    ],
    "build-runtime": true,
    "modules": [
        {
            "name": "astra-qtSdk",
            "buildsystem": "simple",
            "sources": [
                {
                    "type": "archive",
                    "path": "../build_dir/astra-qtsdk.tar.gz",
                    "strip-components": 0,
                    "only-arches": ["x86_64"]
                }
            ],
             "build-commands": [
                "set -ex",
                "/bin/bash -c 'mkdir -p ${FLATPAK_DEST}/usr/{bin,lib,include,share,lib64}'",
                "/bin/bash -c 'mkdir -p ${FLATPAK_DEST}/usr/lib/x86_64-linux-gnu'",
                "/bin/bash -c 'mkdir -p ${FLATPAK_DEST}/usr/include/x86_64-linux-gnu'",
                "/bin/bash -c 'mkdir -p ${FLATPAK_DEST}/usr/lib/qt5/{plugins,qml}'",
                "/bin/bash -c 'mkdir -p ${FLATPAK_DEST}/usr/include/x86_64-linux-gnu/qt5'",
                "/bin/bash -c 'mkdir -p ${FLATPAK_DEST}/usr/lib/cmake/Qt5'",
                "/bin/bash -c 'cp -ar usr/include/x86_64-linux-gnu/qt5 ${FLATPAK_DEST}/usr/include/x86_64-linux-gnu/ || true'",
                "/bin/bash -c 'cp -ar usr/include/qt5 ${FLATPAK_DEST}/usr/include/ || true'",
                "cp -arv usr/lib/x86_64-linux-gnu/libQt5*.so* ${FLATPAK_DEST}/usr/lib/ || true",
                "cp -arv usr/lib/x86_64-linux-gnu/qt5 ${FLATPAK_DEST}/usr/lib/ || true",
                "/bin/bash -c 'cp -ar usr/lib/x86_64-linux-gnu/qt5/plugins/* ${FLATPAK_DEST}/usr/lib/qt5/plugins/ || true'",
                "/bin/bash -c 'mkdir -p ${FLATPAK_DEST}/usr/lib/cmake'",
                "/bin/bash -c 'for f in $(find usr/lib -name \"Qt5*.cmake\"); do cp -av --parents \"$f\" ${FLATPAK_DEST}/; done'",
                "/bin/bash -c 'for f in $(find usr/lib -name \"qt5*.cmake\"); do cp -av --parents \"$f\" ${FLATPAK_DEST}/; done'",
                "ln -sf /usr/include/x86_64-linux-gnu/qt5 ${FLATPAK_DEST}/usr/include/qt5",
                "ln -sf /usr/lib/x86_64-linux-gnu ${FLATPAK_DEST}/usr/lib64",
                "find ${FLATPAK_DEST}/usr/lib -name 'Qt5CoreConfig.cmake' -type f -exec sed -i 's|/usr/include/x86_64-linux-gnu/qt5/|/usr/usr/include/x86_64-linux-gnu/qt5/|g' {} \\;",
                "find ${FLATPAK_DEST}/usr/lib -name 'Qt5CoreConfig.cmake' -type f -exec sed -i 's|/usr/include/qt5/|/usr/usr/include/qt5/|g' {} \\;",
                "echo 'Checking Qt SDK installation:'",
                "ls -la ${FLATPAK_DEST}/usr/include/x86_64-linux-gnu/qt5 || true",
                "ls -la ${FLATPAK_DEST}/usr/lib/cmake/Qt5* || true",
                "find ${FLATPAK_DEST}/usr/lib -name 'libQt5*.so*' || true"
            ]
        }
    ],
    "add-extensions": {
    }
}
