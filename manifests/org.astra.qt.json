{
    "id": "org.astra.Qt",
    "branch": "1.8",
    "runtime": "org.astra.mainPlatform",
    "runtime-version": "1.8",
    "sdk": "org.astra.mainSdk",
    "separate-locales": true,
    "build-runtime": true,
    "cleanup": [
        "/tmp/*",
        "/var/cache",
        "/var/lib/apt",
        "/var/log",
        "/usr/share/doc",
        "/usr/share/man",
        "/usr/share/info",
        "/usr/share/lintian",
        "/usr/share/linda",
        "/var/lib/dpkg/*-old",
        "/var/lib/dbus/machine-id",
        "/usr/share/applications"
    ],
    "modules": [
        {
            "name": "astra-qt",
            "buildsystem": "simple",
            "sources": [
                {
                    "type": "archive",
                    "path": "../build_dir/astra-qt.tar.gz",
                    "strip-components": 0,
                    "only-arches": ["x86_64"]
                }
            ],
             "build-commands": [
                "set -ex",
                "ls -la",
                "mkdir -p ${FLATPAK_DEST}/usr/{lib,share,lib64,include}",
                "mkdir -p ${FLATPAK_DEST}/usr/lib/x86_64-linux-gnu",
                "mkdir -p ${FLATPAK_DEST}/usr/lib/qt5/{plugins,qml}",
                "cp -arv usr/lib/x86_64-linux-gnu/libQt5*.so* ${FLATPAK_DEST}/usr/lib/ || true",
                "cp -arv usr/lib/x86_64-linux-gnu/qt5 ${FLATPAK_DEST}/usr/lib/ || true",
                "/bin/bash -c 'cp -ar usr/lib/x86_64-linux-gnu/qt5/plugins/* ${FLATPAK_DEST}/usr/lib/qt5/plugins/ 2>/dev/null || true'",
                "cp -arv usr/lib/x86_64-linux-gnu/libxcb*.so* ${FLATPAK_DEST}/usr/lib/ || true",
                "cp -arv usr/lib/x86_64-linux-gnu/libX11*.so* ${FLATPAK_DEST}/usr/lib/ || true",
                "cp -arv usr/lib/x86_64-linux-gnu/libxkbcommon*.so* ${FLATPAK_DEST}/usr/lib/ || true",
                "cp -arv usr/lib/x86_64-linux-gnu/libfontconfig*.so* ${FLATPAK_DEST}/usr/lib/ || true",
                "cp -arv usr/lib/x86_64-linux-gnu/libfreetype*.so* ${FLATPAK_DEST}/usr/lib/ || true",
                "cp -arv usr/lib/x86_64-linux-gnu/libglib-2.0*.so* ${FLATPAK_DEST}/usr/lib/ || true",
                "/bin/bash -c 'cp -ar usr/share/qt5 ${FLATPAK_DEST}/usr/share/ 2>/dev/null || true'",
                "/bin/bash -c 'mkdir -p ${FLATPAK_DEST}/usr/share/qt5/translations'",
                "/bin/bash -c 'cp -ar usr/share/qt5/translations/* ${FLATPAK_DEST}/usr/share/qt5/translations/ 2>/dev/null || true'",
                "mkdir -p ${FLATPAK_DEST}/etc/profile.d",
                "echo 'Checking Qt installation:'",
                "find ${FLATPAK_DEST}/usr/lib -name 'libQt5*.so*' || true",
                "ls -la ${FLATPAK_DEST}/usr/lib/qt5/plugins || true",
                "ls -la ${FLATPAK_DEST}/usr/share/qt5/translations || true"
            ]
        }
    ],
    "add-extensions": {}
}
